012-PsIthaca2 Operations
------------------------

+-----------+----------+----------------------------------------------------+
| Name      | Size     | Contents                                           |
+===========+==========+====================================================+
| branch    | 32 bytes | bytes                                              |
+-----------+----------+----------------------------------------------------+
| contents  | Variable | sequence of $012-Psithaca.operation.alpha.contents |
+-----------+----------+----------------------------------------------------+
| signature | 64 bytes | bytes                                              |
+-----------+----------+----------------------------------------------------+


012-Psithaca.scripted.contracts
*******************************

+-----------------------+----------+-------------------------+
| Name                  | Size     | Contents                |
+=======================+==========+=========================+
| # bytes in next field | 4 bytes  | unsigned 30-bit integer |
+-----------------------+----------+-------------------------+
| code                  | Variable | bytes                   |
+-----------------------+----------+-------------------------+
| # bytes in next field | 4 bytes  | unsigned 30-bit integer |
+-----------------------+----------+-------------------------+
| storage               | Variable | bytes                   |
+-----------------------+----------+-------------------------+


012-Psithaca.contract_id (22 bytes, 8-bit tag)
**********************************************

Implicit (tag 0)
================

+---------------------------+----------+------------------------+
| Name                      | Size     | Contents               |
+===========================+==========+========================+
| Tag                       | 1 byte   | unsigned 8-bit integer |
+---------------------------+----------+------------------------+
| Signature.Public_key_hash | 21 bytes | $public_key_hash       |
+---------------------------+----------+------------------------+


Originated (tag 1)
==================

+---------------+----------+------------------------+
| Name          | Size     | Contents               |
+===============+==========+========================+
| Tag           | 1 byte   | unsigned 8-bit integer |
+---------------+----------+------------------------+
| Contract_hash | 20 bytes | bytes                  |
+---------------+----------+------------------------+
| padding       | 1 byte   | padding                |
+---------------+----------+------------------------+


012-Psithaca.entrypoint (Determined from data, 8-bit tag)
*********************************************************

default (tag 0)
===============

+------+--------+------------------------+
| Name | Size   | Contents               |
+======+========+========================+
| Tag  | 1 byte | unsigned 8-bit integer |
+------+--------+------------------------+


root (tag 1)
============

+------+--------+------------------------+
| Name | Size   | Contents               |
+======+========+========================+
| Tag  | 1 byte | unsigned 8-bit integer |
+------+--------+------------------------+


do (tag 2)
==========

+------+--------+------------------------+
| Name | Size   | Contents               |
+======+========+========================+
| Tag  | 1 byte | unsigned 8-bit integer |
+------+--------+------------------------+


set_delegate (tag 3)
====================

+------+--------+------------------------+
| Name | Size   | Contents               |
+======+========+========================+
| Tag  | 1 byte | unsigned 8-bit integer |
+------+--------+------------------------+


remove_delegate (tag 4)
=======================

+------+--------+------------------------+
| Name | Size   | Contents               |
+======+========+========================+
| Tag  | 1 byte | unsigned 8-bit integer |
+------+--------+------------------------+


named (tag 255)
===============

+-----------------------+----------+------------------------+
| Name                  | Size     | Contents               |
+=======================+==========+========================+
| Tag                   | 1 byte   | unsigned 8-bit integer |
+-----------------------+----------+------------------------+
| # bytes in next field | 1 byte   | unsigned 8-bit integer |
+-----------------------+----------+------------------------+
| Unnamed field 0       | Variable | bytes                  |
+-----------------------+----------+------------------------+


X_0
***

+-----------------------+----------------------+--------------------------+
| Name                  | Size                 | Contents                 |
+=======================+======================+==========================+
| entrypoint            | Determined from data | $012-Psithaca.entrypoint |
+-----------------------+----------------------+--------------------------+
| # bytes in next field | 4 bytes              | unsigned 30-bit integer  |
+-----------------------+----------------------+--------------------------+
| value                 | Variable             | bytes                    |
+-----------------------+----------------------+--------------------------+


N.t
***

A variable-length sequence of bytes encoding a Zarith natural number. Each byte has a running unary size bit: the most significant bit of each byte indicates whether this is the last byte in the sequence (0) or whether the sequence continues (1). Size bits ignored, the data is the binary representation of the number in little-endian order.

+------+----------------------+----------+
| Name | Size                 | Contents |
+======+======================+==========+
| N.t  | Determined from data | bytes    |
+------+----------------------+----------+


public_key (Determined from data, 8-bit tag)
********************************************

Ed25519 (tag 0)
===============

+--------------------+----------+------------------------+
| Name               | Size     | Contents               |
+====================+==========+========================+
| Tag                | 1 byte   | unsigned 8-bit integer |
+--------------------+----------+------------------------+
| Ed25519.Public_key | 32 bytes | bytes                  |
+--------------------+----------+------------------------+


Secp256k1 (tag 1)
=================

+----------------------+----------+------------------------+
| Name                 | Size     | Contents               |
+======================+==========+========================+
| Tag                  | 1 byte   | unsigned 8-bit integer |
+----------------------+----------+------------------------+
| Secp256k1.Public_key | 33 bytes | bytes                  |
+----------------------+----------+------------------------+


P256 (tag 2)
============

+-----------------+----------+------------------------+
| Name            | Size     | Contents               |
+=================+==========+========================+
| Tag             | 1 byte   | unsigned 8-bit integer |
+-----------------+----------+------------------------+
| P256.Public_key | 33 bytes | bytes                  |
+-----------------+----------+------------------------+


012-Psithaca.inlined.preendorsement.contents (43 bytes, 8-bit tag)
******************************************************************

Preendorsement (tag 20)
=======================

+--------------------+----------+-------------------------+
| Name               | Size     | Contents                |
+====================+==========+=========================+
| Tag                | 1 byte   | unsigned 8-bit integer  |
+--------------------+----------+-------------------------+
| slot               | 2 bytes  | unsigned 16-bit integer |
+--------------------+----------+-------------------------+
| level              | 4 bytes  | signed 32-bit integer   |
+--------------------+----------+-------------------------+
| round              | 4 bytes  | signed 32-bit integer   |
+--------------------+----------+-------------------------+
| block_payload_hash | 32 bytes | bytes                   |
+--------------------+----------+-------------------------+


012-Psithaca.inlined.preendorsement
***********************************

+------------+----------+-----------------------------------------------+
| Name       | Size     | Contents                                      |
+============+==========+===============================================+
| branch     | 32 bytes | bytes                                         |
+------------+----------+-----------------------------------------------+
| operations | 43 bytes | $012-Psithaca.inlined.preendorsement.contents |
+------------+----------+-----------------------------------------------+
| signature  | Variable | bytes                                         |
+------------+----------+-----------------------------------------------+


public_key_hash (21 bytes, 8-bit tag)
*************************************

Ed25519 (tag 0)
===============

+-------------------------+----------+------------------------+
| Name                    | Size     | Contents               |
+=========================+==========+========================+
| Tag                     | 1 byte   | unsigned 8-bit integer |
+-------------------------+----------+------------------------+
| Ed25519.Public_key_hash | 20 bytes | bytes                  |
+-------------------------+----------+------------------------+


Secp256k1 (tag 1)
=================

+---------------------------+----------+------------------------+
| Name                      | Size     | Contents               |
+===========================+==========+========================+
| Tag                       | 1 byte   | unsigned 8-bit integer |
+---------------------------+----------+------------------------+
| Secp256k1.Public_key_hash | 20 bytes | bytes                  |
+---------------------------+----------+------------------------+


P256 (tag 2)
============

+----------------------+----------+------------------------+
| Name                 | Size     | Contents               |
+======================+==========+========================+
| Tag                  | 1 byte   | unsigned 8-bit integer |
+----------------------+----------+------------------------+
| P256.Public_key_hash | 20 bytes | bytes                  |
+----------------------+----------+------------------------+


fitness.elem
************

+-----------------------+----------+-------------------------+
| Name                  | Size     | Contents                |
+=======================+==========+=========================+
| # bytes in next field | 4 bytes  | unsigned 30-bit integer |
+-----------------------+----------+-------------------------+
| Unnamed field 0       | Variable | bytes                   |
+-----------------------+----------+-------------------------+


012-Psithaca.block_header.alpha.full_header
*******************************************

+---------------------------------------+----------+-------------------------------------+
| Name                                  | Size     | Contents                            |
+=======================================+==========+=====================================+
| level                                 | 4 bytes  | signed 32-bit integer               |
+---------------------------------------+----------+-------------------------------------+
| proto                                 | 1 byte   | unsigned 8-bit integer              |
+---------------------------------------+----------+-------------------------------------+
| predecessor                           | 32 bytes | bytes                               |
+---------------------------------------+----------+-------------------------------------+
| timestamp                             | 8 bytes  | signed 64-bit integer               |
+---------------------------------------+----------+-------------------------------------+
| validation_pass                       | 1 byte   | unsigned 8-bit integer              |
+---------------------------------------+----------+-------------------------------------+
| operations_hash                       | 32 bytes | bytes                               |
+---------------------------------------+----------+-------------------------------------+
| # bytes in field "fitness"            | 4 bytes  | unsigned 30-bit integer             |
+---------------------------------------+----------+-------------------------------------+
| fitness                               | Variable | sequence of $fitness.elem           |
+---------------------------------------+----------+-------------------------------------+
| context                               | 32 bytes | bytes                               |
+---------------------------------------+----------+-------------------------------------+
| payload_hash                          | 32 bytes | bytes                               |
+---------------------------------------+----------+-------------------------------------+
| payload_round                         | 4 bytes  | signed 32-bit integer               |
+---------------------------------------+----------+-------------------------------------+
| proof_of_work_nonce                   | 8 bytes  | bytes                               |
+---------------------------------------+----------+-------------------------------------+
| ? presence of field "seed_nonce_hash" | 1 byte   | boolean (0 for false, 255 for true) |
+---------------------------------------+----------+-------------------------------------+
| seed_nonce_hash                       | 32 bytes | bytes                               |
+---------------------------------------+----------+-------------------------------------+
| liquidity_baking_escape_vote          | 1 byte   | boolean (0 for false, 255 for true) |
+---------------------------------------+----------+-------------------------------------+
| signature                             | 64 bytes | bytes                               |
+---------------------------------------+----------+-------------------------------------+


012-Psithaca.inlined.endorsement_mempool.contents (43 bytes, 8-bit tag)
***********************************************************************

Endorsement (tag 21)
====================

+--------------------+----------+-------------------------+
| Name               | Size     | Contents                |
+====================+==========+=========================+
| Tag                | 1 byte   | unsigned 8-bit integer  |
+--------------------+----------+-------------------------+
| slot               | 2 bytes  | unsigned 16-bit integer |
+--------------------+----------+-------------------------+
| level              | 4 bytes  | signed 32-bit integer   |
+--------------------+----------+-------------------------+
| round              | 4 bytes  | signed 32-bit integer   |
+--------------------+----------+-------------------------+
| block_payload_hash | 32 bytes | bytes                   |
+--------------------+----------+-------------------------+


012-Psithaca.inlined.endorsement
********************************

+------------+----------+----------------------------------------------------+
| Name       | Size     | Contents                                           |
+============+==========+====================================================+
| branch     | 32 bytes | bytes                                              |
+------------+----------+----------------------------------------------------+
| operations | 43 bytes | $012-Psithaca.inlined.endorsement_mempool.contents |
+------------+----------+----------------------------------------------------+
| signature  | Variable | bytes                                              |
+------------+----------+----------------------------------------------------+


012-Psithaca.operation.alpha.contents (Determined from data, 8-bit tag)
***********************************************************************

Seed_nonce_revelation (tag 1)
=============================

+-------+----------+------------------------+
| Name  | Size     | Contents               |
+=======+==========+========================+
| Tag   | 1 byte   | unsigned 8-bit integer |
+-------+----------+------------------------+
| level | 4 bytes  | signed 32-bit integer  |
+-------+----------+------------------------+
| nonce | 32 bytes | bytes                  |
+-------+----------+------------------------+


Double_endorsement_evidence (tag 2)
===================================

+-----------------------+----------+-----------------------------------+
| Name                  | Size     | Contents                          |
+=======================+==========+===================================+
| Tag                   | 1 byte   | unsigned 8-bit integer            |
+-----------------------+----------+-----------------------------------+
| # bytes in next field | 4 bytes  | unsigned 30-bit integer           |
+-----------------------+----------+-----------------------------------+
| op1                   | Variable | $012-Psithaca.inlined.endorsement |
+-----------------------+----------+-----------------------------------+
| # bytes in next field | 4 bytes  | unsigned 30-bit integer           |
+-----------------------+----------+-----------------------------------+
| op2                   | Variable | $012-Psithaca.inlined.endorsement |
+-----------------------+----------+-----------------------------------+


Double_baking_evidence (tag 3)
==============================

+-----------------------+----------------------+----------------------------------------------+
| Name                  | Size                 | Contents                                     |
+=======================+======================+==============================================+
| Tag                   | 1 byte               | unsigned 8-bit integer                       |
+-----------------------+----------------------+----------------------------------------------+
| # bytes in next field | 4 bytes              | unsigned 30-bit integer                      |
+-----------------------+----------------------+----------------------------------------------+
| bh1                   | Determined from data | $012-Psithaca.block_header.alpha.full_header |
+-----------------------+----------------------+----------------------------------------------+
| # bytes in next field | 4 bytes              | unsigned 30-bit integer                      |
+-----------------------+----------------------+----------------------------------------------+
| bh2                   | Determined from data | $012-Psithaca.block_header.alpha.full_header |
+-----------------------+----------------------+----------------------------------------------+


Activate_account (tag 4)
========================

+--------+----------+------------------------+
| Name   | Size     | Contents               |
+========+==========+========================+
| Tag    | 1 byte   | unsigned 8-bit integer |
+--------+----------+------------------------+
| pkh    | 20 bytes | bytes                  |
+--------+----------+------------------------+
| secret | 20 bytes | bytes                  |
+--------+----------+------------------------+


Proposals (tag 5)
=================

+-----------------------+----------+-------------------------+
| Name                  | Size     | Contents                |
+=======================+==========+=========================+
| Tag                   | 1 byte   | unsigned 8-bit integer  |
+-----------------------+----------+-------------------------+
| source                | 21 bytes | $public_key_hash        |
+-----------------------+----------+-------------------------+
| period                | 4 bytes  | signed 32-bit integer   |
+-----------------------+----------+-------------------------+
| # bytes in next field | 4 bytes  | unsigned 30-bit integer |
+-----------------------+----------+-------------------------+
| proposals             | Variable | sequence of bytes       |
+-----------------------+----------+-------------------------+


Ballot (tag 6)
==============

+----------+----------+------------------------+
| Name     | Size     | Contents               |
+==========+==========+========================+
| Tag      | 1 byte   | unsigned 8-bit integer |
+----------+----------+------------------------+
| source   | 21 bytes | $public_key_hash       |
+----------+----------+------------------------+
| period   | 4 bytes  | signed 32-bit integer  |
+----------+----------+------------------------+
| proposal | 32 bytes | bytes                  |
+----------+----------+------------------------+
| ballot   | 1 byte   | signed 8-bit integer   |
+----------+----------+------------------------+


Double_preendorsement_evidence (tag 7)
======================================

+-----------------------+----------+--------------------------------------+
| Name                  | Size     | Contents                             |
+=======================+==========+======================================+
| Tag                   | 1 byte   | unsigned 8-bit integer               |
+-----------------------+----------+--------------------------------------+
| # bytes in next field | 4 bytes  | unsigned 30-bit integer              |
+-----------------------+----------+--------------------------------------+
| op1                   | Variable | $012-Psithaca.inlined.preendorsement |
+-----------------------+----------+--------------------------------------+
| # bytes in next field | 4 bytes  | unsigned 30-bit integer              |
+-----------------------+----------+--------------------------------------+
| op2                   | Variable | $012-Psithaca.inlined.preendorsement |
+-----------------------+----------+--------------------------------------+


Failing_noop (tag 17)
=====================

+-----------------------+----------+-------------------------+
| Name                  | Size     | Contents                |
+=======================+==========+=========================+
| Tag                   | 1 byte   | unsigned 8-bit integer  |
+-----------------------+----------+-------------------------+
| # bytes in next field | 4 bytes  | unsigned 30-bit integer |
+-----------------------+----------+-------------------------+
| arbitrary             | Variable | bytes                   |
+-----------------------+----------+-------------------------+


Preendorsement (tag 20)
=======================

+--------------------+----------+-------------------------+
| Name               | Size     | Contents                |
+====================+==========+=========================+
| Tag                | 1 byte   | unsigned 8-bit integer  |
+--------------------+----------+-------------------------+
| slot               | 2 bytes  | unsigned 16-bit integer |
+--------------------+----------+-------------------------+
| level              | 4 bytes  | signed 32-bit integer   |
+--------------------+----------+-------------------------+
| round              | 4 bytes  | signed 32-bit integer   |
+--------------------+----------+-------------------------+
| block_payload_hash | 32 bytes | bytes                   |
+--------------------+----------+-------------------------+


Endorsement (tag 21)
====================

+--------------------+----------+-------------------------+
| Name               | Size     | Contents                |
+====================+==========+=========================+
| Tag                | 1 byte   | unsigned 8-bit integer  |
+--------------------+----------+-------------------------+
| slot               | 2 bytes  | unsigned 16-bit integer |
+--------------------+----------+-------------------------+
| level              | 4 bytes  | signed 32-bit integer   |
+--------------------+----------+-------------------------+
| round              | 4 bytes  | signed 32-bit integer   |
+--------------------+----------+-------------------------+
| block_payload_hash | 32 bytes | bytes                   |
+--------------------+----------+-------------------------+


Reveal (tag 107)
================

+---------------+----------------------+------------------------+
| Name          | Size                 | Contents               |
+===============+======================+========================+
| Tag           | 1 byte               | unsigned 8-bit integer |
+---------------+----------------------+------------------------+
| source        | 21 bytes             | $public_key_hash       |
+---------------+----------------------+------------------------+
| fee           | Determined from data | $N.t                   |
+---------------+----------------------+------------------------+
| counter       | Determined from data | $N.t                   |
+---------------+----------------------+------------------------+
| gas_limit     | Determined from data | $N.t                   |
+---------------+----------------------+------------------------+
| storage_limit | Determined from data | $N.t                   |
+---------------+----------------------+------------------------+
| public_key    | Determined from data | $public_key            |
+---------------+----------------------+------------------------+


Transaction (tag 108)
=====================

+----------------------------------+----------------------+-------------------------------------+
| Name                             | Size                 | Contents                            |
+==================================+======================+=====================================+
| Tag                              | 1 byte               | unsigned 8-bit integer              |
+----------------------------------+----------------------+-------------------------------------+
| source                           | 21 bytes             | $public_key_hash                    |
+----------------------------------+----------------------+-------------------------------------+
| fee                              | Determined from data | $N.t                                |
+----------------------------------+----------------------+-------------------------------------+
| counter                          | Determined from data | $N.t                                |
+----------------------------------+----------------------+-------------------------------------+
| gas_limit                        | Determined from data | $N.t                                |
+----------------------------------+----------------------+-------------------------------------+
| storage_limit                    | Determined from data | $N.t                                |
+----------------------------------+----------------------+-------------------------------------+
| amount                           | Determined from data | $N.t                                |
+----------------------------------+----------------------+-------------------------------------+
| destination                      | 22 bytes             | $012-Psithaca.contract_id           |
+----------------------------------+----------------------+-------------------------------------+
| ? presence of field "parameters" | 1 byte               | boolean (0 for false, 255 for true) |
+----------------------------------+----------------------+-------------------------------------+
| parameters                       | Determined from data | $X_0                                |
+----------------------------------+----------------------+-------------------------------------+


Origination (tag 109)
=====================

+--------------------------------+----------------------+-------------------------------------+
| Name                           | Size                 | Contents                            |
+================================+======================+=====================================+
| Tag                            | 1 byte               | unsigned 8-bit integer              |
+--------------------------------+----------------------+-------------------------------------+
| source                         | 21 bytes             | $public_key_hash                    |
+--------------------------------+----------------------+-------------------------------------+
| fee                            | Determined from data | $N.t                                |
+--------------------------------+----------------------+-------------------------------------+
| counter                        | Determined from data | $N.t                                |
+--------------------------------+----------------------+-------------------------------------+
| gas_limit                      | Determined from data | $N.t                                |
+--------------------------------+----------------------+-------------------------------------+
| storage_limit                  | Determined from data | $N.t                                |
+--------------------------------+----------------------+-------------------------------------+
| balance                        | Determined from data | $N.t                                |
+--------------------------------+----------------------+-------------------------------------+
| ? presence of field "delegate" | 1 byte               | boolean (0 for false, 255 for true) |
+--------------------------------+----------------------+-------------------------------------+
| delegate                       | 21 bytes             | $public_key_hash                    |
+--------------------------------+----------------------+-------------------------------------+
| script                         | Determined from data | $012-Psithaca.scripted.contracts    |
+--------------------------------+----------------------+-------------------------------------+


Delegation (tag 110)
====================

+--------------------------------+----------------------+-------------------------------------+
| Name                           | Size                 | Contents                            |
+================================+======================+=====================================+
| Tag                            | 1 byte               | unsigned 8-bit integer              |
+--------------------------------+----------------------+-------------------------------------+
| source                         | 21 bytes             | $public_key_hash                    |
+--------------------------------+----------------------+-------------------------------------+
| fee                            | Determined from data | $N.t                                |
+--------------------------------+----------------------+-------------------------------------+
| counter                        | Determined from data | $N.t                                |
+--------------------------------+----------------------+-------------------------------------+
| gas_limit                      | Determined from data | $N.t                                |
+--------------------------------+----------------------+-------------------------------------+
| storage_limit                  | Determined from data | $N.t                                |
+--------------------------------+----------------------+-------------------------------------+
| ? presence of field "delegate" | 1 byte               | boolean (0 for false, 255 for true) |
+--------------------------------+----------------------+-------------------------------------+
| delegate                       | 21 bytes             | $public_key_hash                    |
+--------------------------------+----------------------+-------------------------------------+


Register_global_constant (tag 111)
==================================

+-----------------------+----------------------+-------------------------+
| Name                  | Size                 | Contents                |
+=======================+======================+=========================+
| Tag                   | 1 byte               | unsigned 8-bit integer  |
+-----------------------+----------------------+-------------------------+
| source                | 21 bytes             | $public_key_hash        |
+-----------------------+----------------------+-------------------------+
| fee                   | Determined from data | $N.t                    |
+-----------------------+----------------------+-------------------------+
| counter               | Determined from data | $N.t                    |
+-----------------------+----------------------+-------------------------+
| gas_limit             | Determined from data | $N.t                    |
+-----------------------+----------------------+-------------------------+
| storage_limit         | Determined from data | $N.t                    |
+-----------------------+----------------------+-------------------------+
| # bytes in next field | 4 bytes              | unsigned 30-bit integer |
+-----------------------+----------------------+-------------------------+
| value                 | Variable             | bytes                   |
+-----------------------+----------------------+-------------------------+


Set_deposits_limit (tag 112)
============================

+-----------------------------+----------------------+-------------------------------------+
| Name                        | Size                 | Contents                            |
+=============================+======================+=====================================+
| Tag                         | 1 byte               | unsigned 8-bit integer              |
+-----------------------------+----------------------+-------------------------------------+
| source                      | 21 bytes             | $public_key_hash                    |
+-----------------------------+----------------------+-------------------------------------+
| fee                         | Determined from data | $N.t                                |
+-----------------------------+----------------------+-------------------------------------+
| counter                     | Determined from data | $N.t                                |
+-----------------------------+----------------------+-------------------------------------+
| gas_limit                   | Determined from data | $N.t                                |
+-----------------------------+----------------------+-------------------------------------+
| storage_limit               | Determined from data | $N.t                                |
+-----------------------------+----------------------+-------------------------------------+
| ? presence of field "limit" | 1 byte               | boolean (0 for false, 255 for true) |
+-----------------------------+----------------------+-------------------------------------+
| limit                       | Determined from data | $N.t                                |
+-----------------------------+----------------------+-------------------------------------+




